# Nginx基础架构

**架构设计**
- 模块化设计
- 事件驱动架构
- 请求的多阶段异步处理
- 管理进程，多工作进程设计
- 平台无关的代码实现
- 内存池
- 使用统一管道过滤模式的HTTP过滤模块

**启动nginx处理流程**

```shell
1. 根据命令行得到配置文件路径
2. 如果在升级中，则监听环境变量里传递的监听句柄
3. 调用核心模块的create_conf存放配置文件结构体
4. 解析nginx.conf文件
5. 调用所有核心模块的init_conf函数
6. 创建目录，打开文件，初始化共享内存等等
7. 打开nginx.conf指定的监听端口
8. 调用所有模块的init_conf函数
|
|-- 采用单进程运行nginx -- > 9. 进入single模式 -- > 10. 调用所有模块的init_process方式
|
|-- 采用多进程并发执行nginx -- > 11. 启动master进程
|                          -- > 12. 启动woker进程 -- > 调用所有模块的init_process方式
|                          -- > 14. 启动cache manager进程 -- > 15. 启动cache manager子进程 -- > 16. 关闭父进程启动监听的端口
```